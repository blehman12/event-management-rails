<!-- Create app/views/checkin/success.html.erb -->

<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <% if @participant && @event && @user %>
        <div class="card border-success">
          <div class="card-header bg-success text-white text-center">
            <h4 class="mb-0">Check-in Successful!</h4>
          </div>
          <div class="card-body text-center">
            <i class="fas fa-check-circle fa-4x text-success mb-4"></i>
            
            <h3>Welcome to <%= @event.name %></h3>
            <h5 class="text-primary mb-3"><%= @user.first_name %> <%= @user.last_name %></h5>
            
            <div class="alert alert-success">
              <strong>Successfully checked in at:</strong><br>
              <%= @participant.checked_in_at.strftime('%I:%M %p on %B %d, %Y') %>
            </div>
            
            <!-- Event Details -->
            <div class="card mb-4">
              <div class="card-header bg-light">
                <h6 class="mb-0">Event Information</h6>
              </div>
              <div class="card-body text-start">
                <% if @event.event_date %>
                  <p class="mb-2">
                    <strong>Date:</strong> <%= @event.event_date.strftime('%A, %B %d, %Y') %>
                  </p>
                <% end %>
                
                <% if @event.start_time %>
                  <p class="mb-2">
                    <strong>Time:</strong> 
                    <%= @event.start_time.strftime('%I:%M %p') %>
                    <% if @event.end_time %>
                      - <%= @event.end_time.strftime('%I:%M %p') %>
                    <% end %>
                  </p>
                <% end %>
                
                <% if @event.venue %>
                  <p class="mb-2">
                    <strong>Venue:</strong> <%= @event.venue.name %>
                  </p>
                  <% if @event.venue.address %>
                    <p class="mb-2">
                      <strong>Address:</strong> <%= @event.venue.address %>
                    </p>
                  <% end %>
                <% end %>
                
                <% if @event.description.present? %>
                  <p class="mb-0">
                    <strong>About:</strong> <%= simple_format(@event.description) %>
                  </p>
                <% end %>
              </div>
            </div>
            
            <!-- Additional Information -->
            <div class="alert alert-info">
              <h6>What's Next?</h6>
              <ul class="text-start mb-0">
                <li>Please keep this confirmation for your records</li>
                <li>Check with event staff if you need assistance</li>
                <li>Enjoy the event!</li>
                <% if @event.venue&.contact_info %>
                  <li>Venue contact: <%= @event.venue.contact_info %></li>
                <% end %>
              </ul>
            </div>
            
            <!-- Action Buttons -->
            <div class="d-grid gap-2">
              <button onclick="window.print()" class="btn btn-outline-primary">
                <i class="fas fa-print"></i> Print Confirmation
              </button>
              
              <% if @event.venue&.address %>
                <a href="https://maps.google.com/?q=<%= CGI.escape(@event.venue.address) %>" 
                   target="_blank" 
                   class="btn btn-outline-secondary">
                  <i class="fas fa-map-marker-alt"></i> Get Directions
                </a>
              <% end %>
            </div>
            
            <!-- Feedback -->
            <div class="mt-4">
              <small class="text-muted">
                Having issues? Contact event organizers or show this screen to event staff.
              </small>
            </div>
          </div>
        </div>
        
      <% else %>
        <!-- Error State -->
        <div class="card border-danger">
          <div class="card-header bg-danger text-white text-center">
            <h4 class="mb-0">Check-in Information Not Found</h4>
          </div>
          <div class="card-body text-center">
            <i class="fas fa-exclamation-triangle fa-3x text-danger mb-3"></i>
            <h5>Unable to Display Check-in Details</h5>
            <p>The check-in information could not be retrieved.</p>
            <p class="text-muted">Please contact event staff for assistance.</p>
            
            <div class="d-grid">
              <a href="/checkin" class="btn btn-primary">
                Try Check-in Again
              </a>
            </div>
          </div>
        </div>
      <% end %>
      
      <!-- Event Branding -->
      <div class="text-center mt-4">
        <small class="text-muted">
          Check-in System | <%= Date.current.year %>
        </small>
      </div>
    </div>
  </div>
</div>

<!-- Print-specific styles -->
<style>
@media print {
  .container {
    max-width: none !important;
    margin: 0 !important;
    padding: 20px !important;
  }
  
  .btn, .alert-info ul, .text-muted {
    display: none !important;
  }
  
  .card {
    border: 2px solid #28a745 !important;
    box-shadow: none !important;
  }
  
  .card-header {
    background: #28a745 !important;
    color: white !important;
  }
  
  body {
    font-size: 14px !important;
  }
}

/* Mobile responsiveness */
@media (max-width: 768px) {
  .container {
    padding: 10px;
  }
  
  .fa-4x {
    font-size: 3em !important;
  }
  
  h3 {
    font-size: 1.5rem;
  }
  
  .card-body {
    padding: 1rem;
  }
}

/* Success animation */
@keyframes checkmark {
  0% {
    transform: scale(0);
    opacity: 0;
  }
  50% {
    transform: scale(1.2);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.fa-check-circle {
  animation: checkmark 0.6s ease-in-out;
}

/* High contrast for accessibility */
.alert-success {
  border: 2px solid #28a745;
}

.text-start {
  text-align: left !important;
}
</style>