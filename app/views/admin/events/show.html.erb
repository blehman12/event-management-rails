<div class="d-flex justify-content-between align-items-center mb-4">
  <h2><%= @event.name %></h2>
  <div>
    <%= link_to "Edit Event", edit_admin_event_path(@event), class: "btn btn-warning me-2" %>
    <%= link_to "Manage Participants", admin_event_event_participants_path(@event), class: "btn btn-info me-2" %>
    <%= link_to "Back to Events", admin_events_path, class: "btn btn-outline-secondary" %>
  </div>
</div>

<div class="row">
  <div class="col-md-8">
    <div class="card mb-4">
      <div class="card-header">
        <h5>Event Details</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <p><strong>Date:</strong> <%= @event.event_date&.strftime("%A, %B %d, %Y") %></p>
            <p><strong>Time:</strong> <%= @event.start_time&.strftime("%I:%M %p") %> - <%= @event.end_time&.strftime("%I:%M %p") %></p>
            <p><strong>Venue:</strong> <%= link_to @event.venue.name, admin_venue_path(@event.venue) %></p>
            <p><strong>Capacity:</strong> <%= @event.max_attendees %> people</p>
          </div>
          <div class="col-md-6">
            <p><strong>RSVP Deadline:</strong> <%= @event.rsvp_deadline&.strftime("%B %d, %Y") %></p>
            <p><strong>Created by:</strong> <%= @event.creator.full_name %></p>
            <p><strong>Status:</strong> 
              <% if @event.rsvp_open? %>
                <span class="badge bg-success">RSVP Open</span>
              <% else %>
                <span class="badge bg-danger">RSVP Closed</span>
              <% end %>
            </p>
            <p><strong>Spots Remaining:</strong> <%= @event.spots_remaining %></p>
          </div>
        </div>
        <% if @event.description.present? %>
          <div class="mt-3">
            <strong>Description:</strong>
            <p><%= simple_format(@event.description) %></p>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  
  <div class="col-md-4">
    <div class="card mb-3">
      <div class="card-header">
        <h6>Participation Summary</h6>
      </div>
      <div class="card-body">
        <div class="row text-center">
          <div class="col-6">
            <h4 class="text-success"><%= @participants.yes.count %></h4>
            <small>Confirmed</small>
          </div>
          <div class="col-6">
            <h4 class="text-warning"><%= @participants.maybe.count %></h4>
            <small>Maybe</small>
          </div>
        </div>
        <div class="row text-center mt-2">
          <div class="col-6">
            <h4 class="text-danger"><%= @participants.no.count %></h4>
            <small>Declined</small>
          </div>
          <div class="col-6">
            <h4 class="text-secondary"><%= @participants.pending.count %></h4>
            <small>Pending</small>
          </div>
        </div>
      </div>
    </div>
    
    <div class="card">
      <div class="card-header">
        <h6>Roles</h6>
      </div>
      <div class="card-body">
        <p><strong>Organizers:</strong> <%= @organizers.count %></p>
        <p><strong>Vendors:</strong> <%= @vendors.count %></p>
        <p><strong>Attendees:</strong> <%= @attendees.count %></p>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h6>Organizers</h6>
      </div>
      <div class="card-body">
        <% @organizers.each do |participant| %>
          <div class="mb-2">
            <strong><%= participant.user.full_name %></strong><br>
            <small class="text-muted"><%= participant.user.company %></small>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h6>Vendors</h6>
      </div>
      <div class="card-body">
        <% if @vendors.any? %>
          <% @vendors.each do |participant| %>
            <div class="mb-2">
              <strong><%= participant.user.full_name %></strong><br>
              <small class="text-muted"><%= participant.user.company %></small>
              <br>
              <span class="badge bg-<%= participant.rsvp_status == 'yes' ? 'success' : 'secondary' %>">
                <%= participant.rsvp_status.humanize %>
              </span>
            </div>
          <% end %>
        <% else %>
          <p class="text-muted">No vendors assigned</p>
        <% end %>
      </div>
    </div>
  </div>
  
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h6>Recent RSVPs</h6>
      </div>
      <div class="card-body">
        <% @participants.where.not(responded_at: nil).order(responded_at: :desc).limit(5).each do |participant| %>
          <div class="mb-2">
            <strong><%= participant.user.full_name %></strong><br>
            <span class="badge bg-<%= participant.rsvp_status == 'yes' ? 'success' : 'secondary' %>">
              <%= participant.rsvp_status.humanize %>
            </span>
            <small class="text-muted">
              <%= time_ago_in_words(participant.responded_at) %> ago
            </small>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
