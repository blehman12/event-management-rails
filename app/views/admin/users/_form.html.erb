<div class="row justify-content-center">
  <div class="col-md-8">
    <div class="card">
      <div class="card-body">
        <%= form_with(model: [:admin, @user], local: true) do |form| %>
          <% if @user.errors.any? %>
            <div class="alert alert-danger">
              <h4><%= pluralize(@user.errors.count, "error") %> prohibited this user from being saved:</h4>
              <ul class="mb-0">
                <% @user.errors.full_messages.each do |message| %>
                  <li><%= message %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <div class="row">
            <div class="col-md-6 mb-3">
              <%= form.label :first_name, class: "form-label" %>
              <%= form.text_field :first_name, class: "form-control", required: true %>
            </div>
            <div class="col-md-6 mb-3">
              <%= form.label :last_name, class: "form-label" %>
              <%= form.text_field :last_name, class: "form-control", required: true %>
            </div>
          </div>

          <div class="mb-3">
            <%= form.label :email, class: "form-label" %>
            <%= form.email_field :email, class: "form-control", required: true %>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <%= form.label :company, class: "form-label" %>
              <%= form.text_field :company, class: "form-control" %>
            </div>
            <div class="col-md-6 mb-3">
              <%= form.label :phone, class: "form-label" %>
              <%= form.telephone_field :phone, class: "form-control" %>
            </div>
          </div>

          <% if @user.new_record? %>
            <div class="row">
              <div class="col-md-6 mb-3">
                <%= form.label :password, class: "form-label" %>
                <%= form.password_field :password, class: "form-control", required: true %>
              </div>
              <div class="col-md-6 mb-3">
                <%= form.label :password_confirmation, class: "form-label" %>
                <%= form.password_field :password_confirmation, class: "form-control", required: true %>
              </div>
            </div>
          <% end %>

          <!-- Highlighted Role Section -->
          <div class="mb-3">
            <div class="card border-warning">
              <div class="card-header bg-warning text-dark">
                <h6 class="mb-0">ğŸ” User Role & Permissions</h6>
              </div>
              <div class="card-body">
                <%= form.label :role, "User Role", class: "form-label fw-bold" %>
                <%= form.select :role, 
                    options_for_select([
                      ['Attendee - Can RSVP to events', 'attendee'],
                      ['Admin - Full system access', 'admin']
                    ], @user.role),
                    {}, 
                    { class: "form-select form-select-lg", 
                      style: "border: 2px solid #ffc107;" } %>
                <div class="form-text">
                  <strong>Attendee:</strong> Can view and RSVP to events<br>
                  <strong>Admin:</strong> Can manage users, events, venues, and all system settings
                </div>
                
                <% if @user.persisted? && @user == current_user %>
                  <div class="alert alert-info mt-2 mb-0">
                    <small>ğŸ’¡ This is your own account. You cannot remove your own admin privileges.</small>
                  </div>
                <% end %>
              </div>
            </div>
          </div>

          <div class="mb-3">
            <div class="form-check">
              <%= form.check_box :text_capable, class: "form-check-input" %>
              <%= form.label :text_capable, "Can receive text messages", class: "form-check-label" %>
            </div>
          </div>

          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <%= link_to "Cancel", admin_users_path, class: "btn btn-outline-secondary me-md-2" %>
            <%= form.submit class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
